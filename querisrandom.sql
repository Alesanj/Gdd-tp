USE GD1C2023
GO

EXEC dropear_tablas
exec crear_tablas
exec migrar_tablas
exec borrar_todo;


SELECT *
FROM sys.objects
WHERE type IN ('FN', 'IF', 'TF') 

SELECT *
FROM sys.procedures

exec crear_tablas
SELECT DISTINCT dbo.obtenerTipoAPartirDeNombreMovilidad(REPARTIDOR_TIPO_MOVILIDAD) ,REPARTIDOR_NOMBRE , REPARTIDOR_APELLIDO ,REPARTIDOR_DNI,REPARTIDOR_TELEFONO,REPARTIDOR_DIRECION ,REPARTIDOR_EMAIL ,REPARTIDOR_FECHA_NAC 
FROM gd_esquema.Maestra
	SELECT 
	REPARTIDOR_DNI
	FROM gd_esquema.Maestra
	GROUP BY REPARTIDOR_DNI

	exec borrar_todo

	SELECT DISTINCT REPARTIDOR_TIPO_MOVILIDAD FROM gd_esquema.Maestra

	exec crear_tablas
	EXEC migrar_tablas

	SELECT * FROM NEW_MODEL.USUARIO

	SELECT DISTINCT dbo.obtenerTipoMovilidad(REPARTIDOR_TIPO_MOVILIDAD) ,REPARTIDOR_NOMBRE , REPARTIDOR_APELLIDO ,REPARTIDOR_DNI,REPARTIDOR_TELEFONO,REPARTIDOR_DIRECION ,REPARTIDOR_EMAIL ,REPARTIDOR_FECHA_NAC 
        FROM gd_esquema.Maestra

		

		exec borrar_todo
		exec crear_tablas

		SELECT * FROM NEW_MODEL.TIPO_MOVILIDAD
		SELECT * FROM NEW_MODEL.REPARTIDOR
		EXEC MIGRAR_REPARTIDOR

	exec migrar_tablas

 	    SELECT DISTINCT dbo.obtenerUsuarioNro(USUARIO_DNI)AS USUARIO_NRO ,dbo.obtenerLocalidadNROO(DIRECCION_USUARIO_PROVINCIA,DIRECCION_USUARIO_LOCALIDAD) AS LOCALIDAD_NRO,DIRECCION_USUARIO_NOMBRE,DIRECCION_USUARIO_DIRECCION FROM gd_esquema.Maestra
 	    WHERE DIRECCION_USUARIO_DIRECCION IS NOT NULL
		order by USUARIO_NRO
		


		select * from NEW_MODEL.USUARIO order BY USUARIO_NRO ASC

		EXEC crear_tablas
		EXEC migrar_tablas
		exec borrar_todo